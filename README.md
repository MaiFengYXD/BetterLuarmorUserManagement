# BetterLuarmorUserManagement

![thumbnail](./thumbnail.png)

**BetterLuarmorUserManagement** introduces a super handy intermediate step `issued` between `used` and `unused` to save your team from the usual Luarmor key/user management mess. It keeps everything tidy and organized.

This was born out of frustration with my co-worker and I were constantly bumping into each other and double-sending keys. It's lowkey critical that we need to get a better solution instead of recalling & resending keys repeatedly.

It also has some other basic features to make things easier, and is distributed under the [MIT license](./LICENSE).

## Setup

You need to make a libSQL database to store the user tables generated by this bot. I personally recommend using [Turso](https://turso.tech/).

1. Install [Node.js](https://nodejs.org/en/download/) if you haven't already.
2. Clone this repository:
    ```bash
    git clone https://github.com/MaiFengYXD/BetterLuarmorUserManagement.git
    cd BetterLuarmorUserManagement
    ```
3. Create a `.env` file in the root directory and fill in the following variables:
    ```ini
    # Discord Bot
    CLIENT_ID=client_id
    DISCORD_TOKEN=discord_token

    # Guild
    GUILD_ID=guild_id
    LUARMOR_MANAGER_ROLE_ID=luarmor_manager_role_id

    # Luarmor
    LUARMOR_API_KEY=luarmor_api_key
    LUARMOR_PROJECT_ID=luarmor_project_id

    # libSQL
    DATABASE_URL=database_url
    DATABASE_AUTH_TOKEN=database_auth_token
    ```
4. Run `npm install` to install dependencies
5. Run `npx drizzle-kit push` to push the schema to your database
6. Run `npm run start` to start the bot

## Commands

1. [delete](./src/CommandHandlers/Delete.ts): Delete a key.
    - `key`: The key to delete
2. [delete_unused](./src/CommandHandlers/DeleteUnused.ts): Delete all unused keys.
3. [generate](./src/CommandHandlers/Generate.ts): Generate some keys.
    - `amount`: (optional) The amount of keys to generate (default: 1)
    - `note`: (optional) The note to add (default: null)
4. [list](./src/CommandHandlers/List.ts): Get keys of the specified status.
    - `status`: The status to list (`unused`, `used`, `issued`)
5. [query](./src/CommandHandlers/Query.ts): Query a key's information.
    - `key`: The key to query
6. [roll](./src/CommandHandlers/Roll.ts): Get some unused keys.
    - `amount`: (optional) The amount of keys to roll (default: 1)
    - `note`: (optional) The note to filter by (default: null)
7. [set_status](./src/CommandHandlers/SetStatus.ts): Set a key's status. Used keys cannot be reset to unused.
    - `key`: The key to set status
    - `status`: The status to set (`unused`, `used`, `issued`)

## Todo

- Implement the key duration/days feature
